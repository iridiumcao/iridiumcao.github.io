# ç¬¬ä¹ç«  è¿œç¨‹äº¤äº’

[â‡¦ä¸Šä¸€ç« ](08.md) - [é¦–é¡µğŸ ](index.md) - [ä¸‹ä¸€ç« â‡¨](10.md)

---

- [ç¬¬ä¹ç«  è¿œç¨‹äº¤äº’](#ç¬¬ä¹ç« -è¿œç¨‹äº¤äº’)
  - [1. é€šè¿‡ GitHub åˆ›å»ºè¿œç¨‹åº“](#1-é€šè¿‡-github-åˆ›å»ºè¿œç¨‹åº“)
    - [1.1 åˆ›å»º](#11-åˆ›å»º)
  - [2. åœ¨æœ¬åœ° clone è¿œç¨‹åº“](#2-åœ¨æœ¬åœ°-clone-è¿œç¨‹åº“)
  - [3. è¯•ç”¨æ–°åº“](#3-è¯•ç”¨æ–°åº“)
  - [4. æŸ¥çœ‹åˆ†æ”¯](#4-æŸ¥çœ‹åˆ†æ”¯)
  - [5. åˆ›å»ºåˆ†æ”¯](#5-åˆ›å»ºåˆ†æ”¯)
    - [5.1 å…ˆæœ¬åœ°å†è¿œç¨‹](#51-å…ˆæœ¬åœ°å†è¿œç¨‹)
    - [5.2 å…ˆè¿œç¨‹å†æœ¬åœ°](#52-å…ˆè¿œç¨‹å†æœ¬åœ°)
  - [6. æœ¬åœ°å’Œè¿œç«¯äº¤äº’](#6-æœ¬åœ°å’Œè¿œç«¯äº¤äº’)
  - [7. å…³è”è¿œç¨‹åˆ†æ”¯](#7-å…³è”è¿œç¨‹åˆ†æ”¯)
  - [8. è¿›é˜¶ç¯‡](#8-è¿›é˜¶ç¯‡)
    - [8.1 å…³è”è¿œç¨‹åº“](#81-å…³è”è¿œç¨‹åº“)
    - [8.2 å†è°ˆå…³è”åˆ†æ”¯](#82-å†è°ˆå…³è”åˆ†æ”¯)
    - [8.3 å†è°ˆ fetch/pull](#83-å†è°ˆ-fetchpull)
      - [8.3.1 `fetch`](#831-fetch)
      - [8.3.2 `pull`](#832-pull)
    - [8.4 æ‰¹é‡å¤„ç†å¤šä¸ªåˆ†æ”¯](#84-æ‰¹é‡å¤„ç†å¤šä¸ªåˆ†æ”¯)
    - [8.5 `git branch --merged`](#85-git-branch---merged)
    - [8.6 Git ç½‘ç»œæ‹“æ‰‘ç»“æ„](#86-git-ç½‘ç»œæ‹“æ‰‘ç»“æ„)

---

![](images/ch09_01_git_architecture.png#pic_left)

ä¹‹å‰çš„ç« èŠ‚éƒ½æ˜¯åœ¨æœ¬åœ°æœºå™¨ä¸Šæ“ä½œï¼Œä½†åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¾€å¾€ä¼šç”¨ä¸€ä¸ªå…¬å…±çš„ç‰ˆæœ¬ç®¡ç†æœåŠ¡å™¨ï¼Œå¤§å®¶é€šè¿‡å®ƒåˆ†äº«ä»£ç ï¼Œè¿™ä¸ªæœåŠ¡å™¨ç»å¸¸è¢«ç§°ä¸ºä»£ç æœåŠ¡å™¨ã€‚Git æœ¬èº«èƒ½åšåˆ°å»ä¸­å¿ƒåŒ–ï¼Œä½†å®é™…åº”ç”¨ä¸­ï¼Œå¤§å¤šæ•°æ—¶è¿˜æ˜¯ä½¿ç”¨ä¸­å¿ƒåŒ–æ–¹å¼ã€‚æœ¬ç« é€‰ç”¨ GitHub ä½œä¸ºè¿œç¨‹æœåŠ¡å™¨ï¼Œè®²è§£å¦‚ä½•å’Œè¿œç¨‹äº¤äº’ã€‚å¦‚ä½•æ­å»ºæœåŠ¡å™¨å°†åœ¨åç»­ç« èŠ‚è®²è§£ã€‚

æœ¬ç« æåˆ°çš„å¾ˆå¤šå†…å®¹ï¼Œéƒ½å’Œå‰é¢çš„ç« èŠ‚æœ‰å…³ç³»ï¼Œä½†ä¸æ˜¯é‡å¤ï¼Œå‰é¢ç« èŠ‚å›é¿äº†éœ€è¦è¿œç¨‹äº¤äº’çš„å†…å®¹ï¼Œæœ¬ç« ä¼šä¸€ä¸€è¡¥ä¸Šã€‚

## 1. é€šè¿‡ GitHub åˆ›å»ºè¿œç¨‹åº“

GitHub ä¸æ˜¯ Gitï¼Œå®ƒæ˜¯ä¸€ä¸ªæ‰˜ç®¡ git é¡¹ç›®çš„å¹³å°ï¼Œæ‰€ä»¥å« Git Hub. å…¬å…±çš„ Git ä»“åº“æ‰˜ç®¡æœåŠ¡å¹³å°æœ‰å¾ˆå¤šï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–çš„ï¼Œå¤§åŒå°å¼‚ï¼Œæ— æ‰€è°“ã€‚æœ¬æ–‡é€‰ GitHub æ˜¯å› ä¸ºå®ƒæ˜¯ VCS æ‰˜ç®¡å¹³å°ä¸­æœ€æµè¡Œçš„ã€‚

å¦‚æœæ²¡æœ‰ GitHub è´¦å·ï¼Œè¯·å‰å¾€å®˜æ–¹ç½‘ç«™ <https://github.com> æ³¨å†Œã€‚

æ³¨å†Œåè¯·å°†æœ¬æœºçš„ Public SSH Key ä¸Šä¼ åˆ° GitHub. SSH Key çš„åˆ›å»ºå¯ä»¥å‚è€ƒ [GitHub çš„è¯´æ˜](https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent)ã€‚

1. ç™»å½•åç‚¹å³ä¸Šè§’å¤´åƒ -> Settings -> SSH and GPG keys
2. æŒ‰é¡µé¢æç¤ºæ·»åŠ  Public SSH Keyï¼Œå³ä½ çš„å…¬é’¥ã€‚

æµ‹è¯•è®¾ç½®æ˜¯å¦æˆåŠŸï¼š

```plaintext
$ ssh -T git@github.com
Hi iridiumcao! You've successfully authenticated, but GitHub does not provide shell access.
```

### 1.1 åˆ›å»º

ä»¥ä¸Šæ­¥éª¤å®Œæˆåï¼Œå°±å¯ä»¥åœ¨ GitHub å¹³å°åˆ›å»ºä¸€ä¸ªè¿œç¨‹çš„ Repo äº†ã€‚

æ‰“å¼€ <https://github.com/dashboard>

![](images/ch09_02_github.png#pic_left)

ç‚¹å‡»ç»¿è‰²çš„ New æŒ‰é’®å¼€å§‹åˆ›å»ºæ–°åº“ã€‚

![](images/ch09_03_github_create_new_repo.png#pic_left)

æˆ‘è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ repo: demo20231213

é¡¹ç›®ä¸»é¡µï¼š<https://github.com/iridiumcao/demo20231213>

![](images/ch09_04_github.png#pic_left)

åœ¨é¡¹ç›®ä¸»é¡µä¸Šæ‰¾åˆ°ä»£ç ä»“åº“çš„ SSH URL: git@github.com:iridiumcao/demo20231213.git

## 2. åœ¨æœ¬åœ° clone è¿œç¨‹åº“

å¯ä»¥åœ¨ä»»æ„ç›®å½•æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤å°†è¿œç«¯(GitHub)ä¸Šçš„ä»“åº“ clone åˆ°æœ¬åœ°ï¼š

å‚è€ƒæŒ‡ä»¤ï¼š`git clone {project url}`

å®éªŒè®°å½•ï¼š

```plaintext
$ git clone git@github.com:iridiumcao/demo20231213.git
Cloning into 'demo20231213'...
remote: Enumerating objects: 4, done.
remote: Counting objects: 100% (4/4), done.
remote: Compressing objects: 100% (4/4), done.
remote: Total 4 (delta 0), reused 0 (delta 0), pack-reused 0
Receiving objects: 100% (4/4), 12.52 KiB | 0 bytes/s, done.

$ cd demo20231213/
$ ls
LICENSE  README.md
```

## 3. è¯•ç”¨æ–°åº“

åˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯å¹¶ push åˆ°è¿œç«¯ï¼š

```plaintext
$ git switch -c hello
Switched to a new branch 'hello'

$ git push origin hello
Total 0 (delta 0), reused 0 (delta 0), pack-reused 0
remote:
remote: Create a pull request for 'hello' on GitHub by visiting:
remote:      https://github.com/iridiumcao/demo20231213/pull/new/hello
remote:
To github.com:iridiumcao/demo20231213.git
 * [new branch]      hello -> hello
```

æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼š

```plaintext
$ git branch --all
* hello
  master
  remotes/origin/HEAD -> origin/master
  remotes/origin/hello
  remotes/origin/master
```

![](images/ch09_05_github.png)

åˆ†æ”¯ hello åœ¨æœ¬åœ°å’Œè¿œç¨‹éƒ½æœ‰äº†ï¼š

* æœ¬åœ°ï¼šhello
* è¿œç¨‹ï¼šremotes/origin/hello

Git æç¤ºç•Œé¢éå¸¸äººæ€§åŒ–ï¼Œç»¿è‰²çš„è¡¨ç¤ºå½“å‰çš„æœ¬åœ°åˆ†æ”¯ï¼Œçº¢è‰²çš„è¡¨ç¤ºè¿œç¨‹åˆ†æ”¯ã€‚

## 4. æŸ¥çœ‹åˆ†æ”¯

æŸ¥çœ‹åˆ†æ”¯ç”¨ `git branch`ï¼Œå®ƒæœ‰ä¸€äº›å‚æ•°å¯ä»¥è°ƒèŠ‚è¾“å‡ºç»“æœã€‚

ä¸å¸¦å‚æ•°ï¼ŒæŸ¥çœ‹æœ¬åœ°åˆ†æ”¯ï¼š

```plaintext
$ git branch
* hello
  master
```

`-v` èƒ½æŸ¥çœ‹åˆ°æ›´è¯¦ç»†çš„åˆ†æ”¯ä¿¡æ¯ï¼šåˆ†æ”¯åï¼Œæœ€æœ‰ä¸€ä¸ª commit çš„ id å’Œ messageï¼š

```
$ git branch -v
* hello  d804c28 hi, git!
  master a6f355c Initial commit
```

`-vv` èƒ½æŸ¥çœ‹åˆ°æ¯” `-v` æ›´è¯¦ç»†çš„åˆ†æ”¯ä¿¡æ¯ï¼ŒåŒ…æ‹¬æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯çš„å…³è”æƒ…å†µï¼š

```plaintext
$ git branch -vv
* hello  d804c28 hi, git!
  master a6f355c [origin/master] Initial commit
```

`-r` æˆ– `--remote` æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ï¼š

```plaintext
$ git branch -r
  origin/HEAD -> origin/master
  origin/hello
  origin/master
```

`-rv` æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯è¾ƒè¯¦ç»†çš„ä¿¡æ¯ï¼š

```plaintext
$ git branch -rv
  origin/HEAD   -> origin/master
  origin/hello  d804c28 hi, git!
  origin/master a6f355c Initial commit
```

`git branch -rv` ä¹Ÿå¯ä»¥å†™æˆ `git branch -r -v`

`-a` æˆ– `--all` æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼ŒåŒ…æ‹¬æœ¬åœ°å’Œè¿œç«¯çš„ï¼š

```plaintext
$ git branch --all
* hello
  master
  remotes/origin/HEAD -> origin/master
  remotes/origin/hello
  remotes/origin/master
```

## 5. åˆ›å»ºåˆ†æ”¯

æœ¬åœ°åº“å’Œè¿œç¨‹åº“å…³è”åï¼Œæœ¬åœ°å’Œè¿œç¨‹çš„åˆ†æ”¯ä¹Ÿå¯ä»¥å…³è”èµ·æ¥ï¼Œå½“ç„¶ï¼Œå…³è”æ˜¯å¯ä»¥å»ºç«‹ä¹Ÿå¯ä»¥å–æ¶ˆçš„ã€‚

### 5.1 å…ˆæœ¬åœ°å†è¿œç¨‹

å‚å‰é¢[3. è¯•ç”¨æ–°åº“](#3-è¯•ç”¨æ–°åº“)çš„å†…å®¹ï¼Œæ­¥éª¤å°±æ˜¯ï¼š

1. æœ¬åœ°åˆ›å»ºä¸€ä¸ªåˆ†æ”¯
2. å°†è¿™ä¸ªæ–°åˆ†æ”¯ push åˆ°è¿œç«¯

å®Œæˆåæœ¬åœ°å’Œè¿œç«¯çš„åŒååˆ†æ”¯è‡ªç„¶å°±å…³è”äº†

### 5.2 å…ˆè¿œç¨‹å†æœ¬åœ°

è¿˜å¯ä»¥å…ˆåœ¨è¿œç«¯åº“åˆ›å»ºå¥½åˆ†æ”¯åï¼Œå†åŒæ­¥åˆ°æœ¬åœ°ã€‚å…·ä½“å¯ä»¥ç™»å½•åˆ° GitHub çš„[é¡¹ç›®ä¸»é¡µ](https://github.com/iridiumcao/demo20231213)ï¼Œç„¶ååˆ›å»ºè¿œç¨‹åˆ†æ”¯ï¼Œå‡å¦‚æ–°åˆ›å»ºçš„åˆ†æ”¯æ˜¯ new-remote.

![](images/ch09_06_create_branch.png)

è¿œç«¯åˆ›å»ºçš„åˆ†æ”¯ï¼Œæœ¬åœ°å¿…é¡»å…ˆ `fetch` åˆ°æœ¬åœ°ï¼Œæ‰èƒ½ç»§ç»­ã€‚

å…ˆåˆ°ä»»æ„åˆ†æ”¯æ‰§è¡Œ `git fetch --all` ä»¥ä¸‹è½½æ‰€æœ‰è¿œç«¯çš„å˜åŒ–ï¼š

```plaintext
$ git fetch --all
From github.com:iridiumcao/demo20231213
 * [new branch]      new-remote -> origin/new-remote
```

é€šè¿‡å±å¹•å›æ˜¾å¯çŸ¥æœ‰è¿œç«¯ä¸€ä¸ªæ–°çš„åˆ†æ”¯ `origin/new-remote`ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ‡æ¢è¿‡å»ï¼Œå°±åœ¨æœ¬åœ°åˆ›å»ºäº†ä¸€ä¸ªåŒåçš„åˆ†æ”¯ï¼Œå¹¶ä¸”å’Œè¿œç«¯è‡ªåŠ¨å…³è”èµ·æ¥äº†ï¼š

```plaintext
$ git switch new-remote
Switched to a new branch 'new-remote'
branch 'new-remote' set up to track 'origin/new-remote'.
```

## 6. æœ¬åœ°å’Œè¿œç«¯äº¤äº’

è¿œç¨‹æœåŠ¡å™¨çš„æ„ä¹‰åœ¨äºå®ƒæ˜¯ä¸€ä¸ªå…¬å…±åˆ†äº«ä»£ç çš„åœ°æ–¹ï¼Œå¼ ä¸‰æäº¤çš„ä»£ç ï¼Œæå››å¯ä»¥é€šè¿‡è¿œç¨‹åº“è·å–ï¼ŒåŒæ ·ï¼Œæå››æäº¤çš„ï¼Œå¼ ä¸‰ä¹Ÿå¯ä»¥å–åˆ°ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨ä¸¤ç§æ–¹å¼æ¨¡æ‹Ÿå¤šäººåä½œï¼Œå‡å®šåªæœ‰å¼ ä¸‰å’Œæå››ä¸¤ä¸ªäººã€‚

* ç¬¬ä¸€ç§ï¼šç”¨ä¸¤å°ç”µè„‘æ¨¡æ‹Ÿå¼ ä¸‰å’Œæå››çš„è®¾å¤‡
* ç¬¬äºŒç§ï¼šå®‰è£…ä¸¤ä¸ªè™šæ‹Ÿæœºå½“å¼ ä¸‰å’Œæå››çš„
* ç¬¬ä¸‰ç§ï¼šå°†è¿œç¨‹ä»£ç  pull åˆ°åŒä¸€å°æœºå™¨çš„ä¸¤ä¸ªä¸åŒçš„æ–‡ä»¶å¤¹ã€‚

æˆ‘ä»¬è¿™é‡Œé‡‡ç”¨ç¬¬ä¸‰ç§æ–¹å¼ï¼Œæœ€çœäº‹ã€‚

ã€1. ç»™å¼ ä¸‰å’Œæå››åˆ†åˆ«åˆ›å»ºæœ¬åœ°åº“ã€‘

```plaintext
$ git clone git@github.com:iridiumcao/demo20231213.git demo_zhangsan
$ git clone git@github.com:iridiumcao/demo20231213.git demo_lisi
```

ã€2. å¼ ä¸‰æ·»åŠ æ–°æ”¹åŠ¨ï¼Œæå››è·å–ã€‘

å¼ ä¸‰ _ï¼ˆä»¥ä¸‹æŒ‡ä»¤åœ¨å¼ ä¸‰çš„ç›®å½• demo_zhangsan é‡Œæ‰§è¡Œï¼‰_

```plaintext
$ echo "morning, this is zhangsna." >> hello.txt
$ git status
$ git add .
$ git status
$ git commit -m "hello from zhangsan"
$ git status
$ git push origin master
```

ä¸ºäº†èŠ‚çœç¯‡å¹…ï¼Œæœ¬æ–‡éƒ¨åˆ†ç¤ºä¾‹ä»…ä»…è´´ä¸ŠæŒ‡ä»¤ï¼Œä¸ç²˜è´´å±å¹•å›æ˜¾å†…å®¹ã€‚`git status` å¯ä»¥éšæ—¶ç”¨ï¼Œç”¨æ¥è§‚å¯Ÿä»“åº“çš„çŠ¶æ€ï¼Œåé¢çš„ä¾‹å­ä¸­ä¼šä¸å†è´´è¿™ä¸ªæŒ‡ä»¤ï¼Œä½†è¯»è€…ä¸€å®šè¦å¤šç”¨ã€‚

æå›› _ï¼ˆä»¥ä¸‹æŒ‡ä»¤åœ¨æå››çš„ç›®å½• demo_lisi é‡Œæ‰§è¡Œï¼‰_

```plaintext
$ git pull
remote: Enumerating objects: 4, done.
remote: Counting objects: 100% (4/4), done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 3 (delta 0), reused 3 (delta 0), pack-reused 0
Unpacking objects: 100% (3/3), 316 bytes | 31.00 KiB/s, done.
From github.com:iridiumcao/demo20231213
   a6f355c..2e25383  master     -> origin/master
Updating a6f355c..2e25383
Fast-forward
 hello.txt | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 hello.txt
```

å‚ä¸Šé¢çš„å±æ˜¾æç¤ºï¼Œå¯ä»¥çŸ¥é“å‰é¢å¼ ä¸‰çš„æ”¹åŠ¨æå››å·²ç»è·å–åˆ°äº†ã€‚å¯ä»¥ç”¨ `git show` æŸ¥çœ‹æœ€åä¸€ä¸ª commit ä»¥éªŒè¯ï¼š

```plaintext
$ git show
commit 2e2538307881b345c8f9054924e922fb55b28da5 (HEAD -> master, origin/master, origin/HEAD)
Author: Cao Yi <iridiumcao@gmail.com>
Date:   Sun Dec 17 08:29:58 2023 +0800

    hello from zhangsan

diff --git a/hello.txt b/hello.txt
new file mode 100644
index 0000000..128dc6e
--- /dev/null
+++ b/hello.txt
@@ -0,0 +1 @@
+morning, this is zhangsna.
```

ã€3. å¼ ä¸‰æ·»åŠ æ–°åˆ†æ”¯ï¼Œæå››è·å–ã€‘

å¼ ä¸‰ _ï¼ˆä»¥ä¸‹æŒ‡ä»¤åœ¨å¼ ä¸‰çš„ç›®å½• demo_zhangsan é‡Œæ‰§è¡Œï¼‰_

```plaintext
$ git switch -c new_branch_by_z3
Switched to a new branch 'new_branch_by_z3'

$ git push origin new_branch_by_z3
Total 0 (delta 0), reused 0 (delta 0), pack-reused 0
remote:
remote: Create a pull request for 'new_branch_by_z3' on GitHub by visiting:
remote:      https://github.com/iridiumcao/demo20231213/pull/new/new_branch_by_z3
remote:
To github.com:iridiumcao/demo20231213.git
 * [new branch]      new_branch_by_z3 -> new_branch_by_z3

```

æå›› _ï¼ˆä»¥ä¸‹æŒ‡ä»¤åœ¨æå››çš„ç›®å½• demo_lisi é‡Œæ‰§è¡Œï¼‰_

```plaintext
$ git pull
From github.com:iridiumcao/demo20231213
 * [new branch]      new_branch_by_z3 -> origin/new_branch_by_z3
Already up to date.

$ git checkout new_branch_by_z3
Switched to a new branch 'new_branch_by_z3'
branch 'new_branch_by_z3' set up to track 'origin/new_branch_by_z3'.

```

ã€4. å¼ ä¸‰åˆ é™¤åˆ†æ”¯ï¼Œæå››è·å–ã€‘

å¼ ä¸‰ _ï¼ˆä»¥ä¸‹æŒ‡ä»¤åœ¨å¼ ä¸‰çš„ç›®å½• demo_zhangsan é‡Œæ‰§è¡Œï¼‰_

```plaintext
$ git push origin --delete new_branch_by_z3
To github.com:iridiumcao/demo20231213.git
 - [deleted]         new_branch_by_z3
```

æå›› _ï¼ˆä»¥ä¸‹æŒ‡ä»¤åœ¨æå››çš„ç›®å½• demo_lisi é‡Œæ‰§è¡Œï¼‰_

```plaintext
$ git pull origin
Your configuration specifies to merge with the ref 'refs/heads/new_branch_by_z3'
from the remote, but no such ref was fetched.
```

ä»ä¸Šé¢çœ‹åˆ°ï¼Œè¿œç«¯çš„åˆ†æ”¯ `new_branch_by_z3` å·²ç»è·å–ä¸åˆ°äº†ã€‚æ¸…ç†ä¸€ä¸‹æœ¬åœ°å¯¹è¿œç«¯åº“çš„å¼•ç”¨ï¼š

```plaintext
$ git remote prune origin
Pruning origin
URL: git@github.com:iridiumcao/demo20231213.git
 * [pruned] origin/new_branch_by_z3

```

ã€5. å†²çªå¤„ç†å’Œå¼ºåˆ¶æ¨é€è¯´æ˜ã€‘

å¦‚æœä¸€ä¸ªåˆ†æ”¯ï¼Œå¼ ä¸‰å’Œæå››éƒ½åœ¨ä¿®æ”¹ï¼Œä»–ä»¬å¯¹åŒä¸€æ–‡ä»¶çš„åšçš„ä¿®æ”¹å¯èƒ½å†²çªï¼Œè¿™ç§æƒ…å†µï¼Œåº”è¯¥å…ˆè§£å†³å†²çªï¼Œæ…ç”¨ `git push --force` æŒ‡ä»¤ï¼Œå¸¦äº† `--force` å‚æ•°çš„ `push` å°†ç”¨å½“å‰ç”¨æˆ·çš„æ”¹åŠ¨è¦†ç›–æ‰æœåŠ¡å™¨çš„ï¼Œé™¤éä½ ç¡®ä¿¡è¦è¿™ä¹ˆåšï¼Œå¦åˆ™æ°¸è¿œåˆ«ç”¨å®ƒã€‚

ã€6. å°ç»“ã€‘

æœ¬åœ°å’Œè¿œç«¯çš„äº¤äº’ä¸»è¦é€šè¿‡è¿™ä¸‰ä¸ªæŒ‡ä»¤ï¼š`fetch` / `pull` / `push`

* `git fetch` è·å–è¿œç«¯çš„å˜åŒ–ï¼Œä½†ä¸æ”¹å˜å·¥ä½œåŒºçš„ HEADï¼Œæ¯”å¦‚å½“å‰åˆ†æ”¯æœ‰æ›´æ–°çš„åŒ–ï¼Œ`pull` æ‰§è¡Œç»“æŸåï¼ŒHEAD ä¸ä¼šæŒ‡å‘æœ€æ–°çš„ commit
* `git pull` ä»é»˜è®¤ä»“åº“çš„é»˜è®¤å…³è”çš„ä»“åº“ä¸­æ‹‰å–ï¼Œä¼šæ”¹å˜å·¥ä½œåŒºçš„ HEADï¼Œæ¯”å¦‚å½“å‰åˆ†æ”¯æœ‰æ›´æ–°çš„åŒ–ï¼Œ`pull` æ‰§è¡Œç»“æŸåï¼ŒHEAD ä¼šæŒ‡å‘æœ€æ–°çš„ commit
* `git pull origin develop` ä» origin çš„ develop åˆ†æ”¯æ‹‰å–
* `git push` æœ€ç®€å•çš„æ¨é€å‘½ä»¤ï¼Œå°†æ¨é€åˆ°é»˜è®¤å…³è”çš„åˆ†æ”¯ä¸Šï¼Œä½†ä¹Ÿåªèƒ½åœ¨é»˜è®¤åˆ†æ”¯ä¸Šæ‰§è¡Œã€‚æ…ç”¨ `--force` å‚æ•°
* `git push origin develop` æ¨é€åˆ°æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯ä¸Šï¼Œå¦‚æœè¿™ä¸ªåˆ†æ”¯æ˜¯ç¬¬ä¸€æ¬¡æ¨é€ï¼Œåˆ™åœ¨æ¨é€åï¼Œæœ¬åœ°å½“å‰çš„åˆ†æ”¯å°†å’Œè¿œç¨‹åŒåçš„åˆ†æ”¯å»ºç«‹è”ç³»

## 7. å…³è”è¿œç¨‹åˆ†æ”¯

æœ¬åœ°åº“è¦é€šè¿‡è¿œç«¯åº“åˆ†äº«ä»£ç ï¼Œå°±éœ€è¦æŠŠæœ¬åœ°åˆ†æ”¯å’Œè¿œç«¯çš„åˆ†æ”¯å…³è”èµ·æ¥ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ `pull` æˆ– `push` æ—¶å¯ä»¥è‡ªåŠ¨å…³è”åˆ†æ”¯ã€‚éœ€è¦æ³¨æ„ï¼Œ`push` æ—¶éœ€è¦åŠ å‚æ•° `--set-upstream` (å¯ç®€ä½œ `-u`) æ‰èƒ½å»ºç«‹å…³è”ã€‚

```plaintext
$ git push --set-upstream origin test5
$ git branch -vv
  main  c540eeb [origin/main] hello
  test2 c540eeb [origin/test2] hello
* test5 c540eeb [origin/test5] hello
```

æŸ¥çœ‹åˆ°æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯çš„å…³è”çŠ¶æ€: `git branch -vv`ã€‚`git remote show origin` å¯ä»¥æ›´æ¸…æ¥šæŸ¥çœ‹æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯çš„å…³è”çŠ¶æ€(åˆ† git pull, git push ä¸¤ç§æƒ…å†µåˆ†åˆ«æ˜¾ç¤º)

è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯æœ¬åœ°æ–°å»ºçš„åˆ†æ”¯ï¼Œå®ƒæ˜¯ä¸ä¼šè‡ªåŠ¨å’Œè¿œç¨‹æŸä¸ªåˆ†æ”¯å…³è”çš„ï¼Œå¯ä»¥é€šè¿‡æŒ‡ä»¤è®¾ç½®ï¼Œä¾‹å¦‚ï¼š

```plaintext
$ git branch --set-upstream-to=origin/test6
```

ä¸Šé¢çš„æŒ‡ä»¤ä¼šå°†å½“å‰åˆ†æ”¯å’Œè¿œç¨‹çš„ `origin/test6` å…³è”èµ·æ¥ã€‚å¦‚æœè¦è´¹å½“å‰åˆ†æ”¯çš„å…³è”ï¼Œå¯ä»¥åŠ ä¸Šæœ¬åœ°çš„åˆ†æ”¯åï¼š`git branch --set-upstream-to=origin/{remote branch name} {local branch name}`.

ä½†å…¶å®ä¸å»ºç«‹å…³è”ä¹Ÿä¸å½±å“ `pull`, `push`ï¼Œä½†å»ºç«‹å…³è”æœ‰ä¸ªå¥½å¤„æ˜¯æ‰§è¡Œ `pull` æˆ– `push` æŒ‡ä»¤å¯ä»¥ç”¨ç®€å†™æ¨¡å¼ã€‚

## 8. è¿›é˜¶ç¯‡

_è¿›é˜¶ç¯‡çš„å†…å®¹åœ¨å¯¹ git æœ‰ä¸€å®šä½¿ç”¨ç»éªŒåé˜…è¯»æ›´ä½³ï¼Œåˆå­¦è€…å¯ä»¥è·³è¿‡ã€‚_

### 8.1 å…³è”è¿œç¨‹åº“

æœ¬åœ°åº“è¦é€šè¿‡è¿œç«¯åº“åˆ†äº«ä»£ç ï¼Œé¦–å…ˆè¦å°†æœ¬åœ°åº“å’Œè¿œç«¯åº“å…³è”èµ·æ¥ã€‚é€šè¿‡ `git clone` æ“ä½œå»ºç«‹çš„æ–°åº“ä¼šè‡ªåŠ¨å°†æœ¬åœ°åº“å’Œå®ƒ `clone` çš„è¿œç«¯åº“å…³è”èµ·æ¥ã€‚å¦‚ï¼š

```plaintext
$ git clone git@github.com:iridiumcao/demo20231213.git
$ cd demo20231213/
$ git remote -v
origin  git@github.com:iridiumcao/demo20231213.git (fetch)
origin  git@github.com:iridiumcao/demo20231213.git (push)
```

æœ¬åœ° git åº“å’Œè¿œç¨‹ git å…³è”æœ‰ä¸¤ç§æ–¹å¼ï¼š

1. å…ˆå»ºè¿œç¨‹åº“ï¼Œæœ¬åœ°é€šè¿‡ cloneï¼Œå®Œæˆä»“åº“çš„å»ºç«‹å’Œå…³è”ï¼Œå¦‚ä¸Šé¢ä¾‹å­æ‰€ç¤ºã€‚
2. è¿˜æœ‰ä¸€ç§æ˜¯å…ˆå»ºæœ¬åœ°åº“ï¼Œå†å’Œè¿œç¨‹åº“å…³è”ã€‚ä¸‹é¢ç¤ºèŒƒè®²è§£ï¼š

```plaintext
$ git init demo_another
$ cd demo_another/
$ git remote -v
```

ä¸Šé¢çš„æŒ‡ä»¤åˆ›å»ºäº†ä¸€ä¸ªç©ºåº“ `demo_another`ï¼Œé€šè¿‡ `git remote -v` æŸ¥çœ‹å…³è”çš„è¿œç¨‹åº“ï¼Œæ˜¯ç©ºçš„ã€‚ä¸‹é¢æˆ‘ä»¬æ·»åŠ è¿œç¨‹åº“çš„é“¾æ¥ï¼š

```plaintext
$ git remote add origin git@github.com:iridiumcao/demo20231213.git
$ git remote -v
origin  git@github.com:iridiumcao/demo20231213.git (fetch)
origin  git@github.com:iridiumcao/demo20231213.git (push)
```

è¿œç¨‹åº“ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªï¼Œçº¦å®šä¿—æˆçš„åç§°æ˜¯ `origin`ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥èµ·å…¶ä»–åç§°ã€‚

### 8.2 å†è°ˆå…³è”åˆ†æ”¯

`git remote show origin` åˆ† `pull` å’Œ `push` æ˜¾ç¤ºæ¯” `git branch -vv` æ›´åŠ è¯¦ç»†çš„æœ¬åœ°åº“å’Œè¿œç«¯åº“çš„å…³è”æƒ…å†µï¼Œä¾‹å¦‚

```plaintext
$ git remote show origin
* remote origin
  Fetch URL: ...
  Push  URL: ...
  HEAD branch: main
  Remote branches:
    main  tracked
    test2 tracked
    ...
  Local branches configured for 'git pull':
    main  merges with remote main
    test3 merges with remote test4
    ...
  Local refs configured for 'git push':
    main  pushes to main  (up to date)
    test2 pushes to test2 (up to date)
    ...
```

* `git branch --set-upstream-to=origin/{remote branch name}` å°†å½“å‰çš„æœ¬åœ°åˆ†æ”¯çš„ push å’Œè¿œç¨‹çš„ `origin/{remote branch name}` å…³è”èµ·æ¥
* `git branch -b {local branch name} -t origin/{remote branch name}` å°† pull å’Œ push éƒ½ä¸è¿œç¨‹çš„åˆ†æ”¯å…³è”èµ·æ¥äº†
  * è¿™æ¡æŒ‡ä»¤çš„ `-t` æ ‡è®°å¯ä»¥çœç•¥ï¼š`git branch -b {local branch name} origin/{remote branch name}`

å‚ï¼š

* <http://serverfault.com/questions/175052/how-to-tell-which-local-branch-is-tracking-which-remote-branch-in-git>
* <http://stackoverflow.com/questions/4950725/how-do-i-get-git-to-show-me-which-branches-are-tracking-what>

### 8.3 å†è°ˆ fetch/pull

å¹³å¸¸å·¥ä½œä¸­ï¼Œç”¨ `pull` å¤š `fetch`ï¼Œä½†è¿™ä¸¤ä¸ªæŒ‡ä»¤æ˜¯éå¸¸ç›¸å…³çš„ã€‚

#### 8.3.1 `fetch`

é€šè¿‡ `git fetch` å¯ä»¥è·å–è¿œç¨‹çš„å˜åŒ–

* `git fetch --all` è·å–è¿œç¨‹æ‰€æœ‰çš„å˜åŒ–
* `git fetch origin test2` è·å–è¿œç¨‹åº“ origin çš„åˆ†æ”¯ test2 å˜åŒ–

æ‰§è¡Œä¸Šè¿°æŒ‡ä»¤åï¼Œå¦‚æœå½“å‰åˆ†æ”¯åœ¨è¿œç«¯æœ‰æ–°çš„å˜åŒ–ï¼Œæ‰§è¡Œ `git status` æ—¶å±å¹•ä¼šæç¤ºç”¨æˆ·æ‰§è¡Œ `git pull` å»æ›´æ–°ã€‚

ç”¨å›¾è¯´æ˜å¦‚ä¸‹ï¼š

æ›´æ–°å‰ï¼š

```plaintext
                        HEAD
                         /
    o---o---o---o---o---o  a branch
  root
```

æ›´æ–°å(æ‰§è¡Œ `git fetch`)ï¼š

```plaintext
                        HEAD
                         /
    o---o---o---o---o---o---o---o  a branch
  root
```

å¯è§ï¼Œå³ä½¿æœ‰æ–°çš„æ”¹åŠ¨ï¼Œ`fetch` åªæ˜¯æŠŠæ–°çš„æ”¹åŠ¨æ”¾åˆ° Repository è€Œå·²ï¼Œä¸ä¼šæ”¹å˜ Working Directory çš„ä»»ä½•ä¸œè¥¿ã€‚

#### 8.3.2 `pull`

ç›´è§‚ä¸Šçœ‹ï¼Œ`pull` ä¸ `fetch` æœ€å¤§çš„ä¸åŒæ˜¯åº“æ›´æ–°åï¼Œå®ƒä¼šè°ƒæ•´ `HEAD` åˆ°æœ€æ–°çš„å˜åŒ–ä¸Šã€‚

æ›´æ–°å‰ï¼š

```plaintext
                        HEAD
                         /
    o---o---o---o---o---o  a branch
  root
```

æ›´æ–°å(æ‰§è¡Œ `git pull`)ï¼š

```plaintext
                                HEAD
                                 /
    o---o---o---o---o---o---o---o  a branch
  root
```

`pull` æŒ‡ä»¤å®é™…ä¸Šä¸€ä¸ªåˆæˆæŒ‡ä»¤ï¼Œå®ƒæœ‰ä¸¤ç§æ¨¡å¼ï¼š

* `pull = fetch + merge` å°†è¿œç¨‹çš„å˜åŒ– `fetch` åˆ°ï¼Œç„¶ååˆå¹¶åˆ°æœ¬åœ°åˆ†æ”¯
* `pull = fetch + rebase` å°†è¿œç¨‹çš„å˜åŒ– `fetch` åˆ°ï¼Œç„¶åå¯¹è¿œç¨‹çš„å˜åŒ–åš `rebase`.

è¿™ä¸ªæ¨¡å¼å¯ä»¥é€šè¿‡é…ç½® `$ git config pull.rebase` è°ƒèŠ‚ï¼Œæ¯”å¦‚

```plaintext
$ git config pull.rebase true
```

é»˜è®¤å€¼æ˜¯ `false`.

å¦‚æœä¸è€ƒè™‘é»˜è®¤å€¼ï¼Œä½†åœ¨ `pull` æ—¶è¦ä½¿ç”¨ `rebase` æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨æŒ‡ä»¤ `git pull --rebase`ï¼Œå¦‚ï¼š

```plaintext
$ git pull origin test2 --rebase
```

å…¶ä»–ã€‚æ–°å¢ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†ä¸æ‰§è¡Œ `git add`, å¯ä»¥åœ¨ git repo ä¸Šæ‰§è¡Œ `git pull` è€Œæ— ç¢ã€‚

å…¶ä»–ã€‚ä»æœ¬åœ°æ¨é€åˆ†æ”¯ï¼Œå¦‚æœå¤±è´¥ï¼Œå…ˆç”¨ `git pull` æŠ“å–è¿œç¨‹çš„æ–°æäº¤å†é‡æ–° `push`.

### 8.4 æ‰¹é‡å¤„ç†å¤šä¸ªåˆ†æ”¯

æœ‰äº›æŒ‡ä»¤æ”¯æŒåŒäº‹åº”ç”¨åˆ°å¤šä¸ªåˆ†æ”¯ï¼Œè¿™é‡Œä¸¾ä¸€äº›ä¾‹å­ï¼š

è·å–å…¨éƒ¨å˜åŒ–

```plaintext
$ git fetch --all
```

åˆ é™¤å¤šä¸ª branch

```plaintext
$ git branch -D helloworld001 helloworld002 helloworld003
```

æ¨é€å¤šä¸ªè¿œç¨‹ branch

```plaintext
$ git push origin helloworld001 helloworld002 helloworld003
$ git push origin refs/heads/helloworld001 refs/heads/helloworld002 refs/heads/helloworld003
```

åˆ é™¤å¤šä¸ªè¿œç¨‹ branch

```plaintext
$ git push origin --delete helloworld001 helloworld002 helloworld003
$ git push origin refs/heads/helloworld001 refs/heads/helloworld002 refs/heads/helloworld003
```

åˆ é™¤å¤šä¸ª tag

```plaintext
$ git tag --delete test_tag1 test_tag2 test_tag3
```

æ¨é€å¤šä¸ªè¿œç¨‹ tag

```plaintext
$ git push origin test_tag1 test_tag2 test_tag3
$ git push origin refs/tags/test_tag1 refs/tags/test_tag2 refs/heads/test_tag3
```

åˆ é™¤å¤šä¸ªè¿œç¨‹ tag

```plaintext
$ git push origin --delete test_tag1 test_tag2 test_tag3
$ git push origin --delete refs/tags/test_tag1 refs/tags/test_tag2 refs/heads/test_tag3
```

`refs/tags/test_tag1` æ˜¯ `test_tag1` çš„å®Œæ•´åç§°ï¼Œ`refs/heads/helloworld001` æ˜¯ `helloworld001` çš„å®Œæ•´åç§°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ç®€ç§°å°±å¤Ÿäº†ï¼Œä½†æœ‰æ—¶ branch å’Œ tag åŒåï¼Œå°±å¿…é¡»ä½¿ç”¨å®Œæ•´åç§°ã€‚

### 8.5 `git branch --merged`

ä¸€ä¸ª commit å¯èƒ½å­˜åœ¨å¤šä¸ª branch ä¸Šï¼Œå¯ä»¥é€šè¿‡ `git branch --merged` æ‰¾åˆ°ï¼Œä¾‹å¦‚

```plaintext
$ git branch --merged c540eeb
  main
  test2
* test5
  test6
```

ä¸Šé¢æ‰¾åˆ°äº†æ‰€æœ‰åŒ…å« c540eeb çš„åˆ†æ”¯ã€‚è¿™ä¸ªæŒ‡ä»¤å¯ä»¥å’Œè¿œç¨‹æŒ‡ä»¤ç»“åˆèµ·æ¥ç”¨ï¼Œå¦‚æœä¸è·Ÿ commit id, å°±è¡¨ç¤ºæŸ¥æœ¬åˆ†æ”¯åŒ…å«å“ªäº›åˆ†æ”¯çš„å…¨éƒ¨å†…å®¹ï¼Œä¾‹å¦‚ï¼š

```plaintext
$ git checkout master
$ git pull origin master
$ git branch -r --merged
  origin/helloworld001
  origin/helloworld003
  origin/helloworld005
  origin/master
```

å®ƒæ˜¯è¯´åœ¨è¿œç«¯åº“ä¸­ï¼Œè¿™ä¸‰ä¸ªåˆ†æ”¯éƒ½å·²ç»åˆå¹¶åˆ° master äº†ï¼š`helloworld001`, `helloworld002` and `helloworld003`.

### 8.6 Git ç½‘ç»œæ‹“æ‰‘ç»“æ„

Git æ˜¯å»ä¸­å¿ƒåŒ–çš„ï¼Œå®ƒçš„èŠ‚ç‚¹å¯ä»¥ç½‘çŠ¶æ–¹å¼è¿æ¥ï¼Œå¦‚ï¼š

![](images/ch09_07_decentralized_network.png)

ä½†ä¸€èˆ¬çš„å¼€å‘å›¢é˜Ÿè¿˜æ˜¯é€‰ç”¨ä¸­å¿ƒåŒ–ç½‘ç»œç»“æ„ï¼š

![](images/ch09_08_centralized_network.png)

å…¶å®è¿™ä¹ˆé€‰æ‹©è¿˜æ˜¯æœ‰é“ç†çš„ï¼Œå¦‚æœä¸­å¿ƒåŒ–æœåŠ¡å™¨åæ‰ï¼Œæ•°æ®å¹¶ä¸ä¼šä¸¢ï¼Œæˆ‘ä»¬å†é€‰ä¸€ä¸ªå…¶ä»–æ­£å¸¸çš„èŠ‚ç‚¹åšä¸ºæ–°çš„ä¸­å¿ƒå°±å¥½äº†ã€‚

---

[â‡¦ä¸Šä¸€ç« ](08.md) - [é¦–é¡µğŸ ](index.md) - [ä¸‹ä¸€ç« â‡¨](10.md)
