<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

# Reading Through the Bitcoin White Paper, é€šè¯»æ¯”ç‰¹å¸ç™½çš®ä¹¦

[â‡¦ä¸Šä¸€ç« ](wp10.md) - [è¿”å›ç›®å½•ğŸ“–](whitepaper.md) - [ä¸‹ä¸€ç« â‡¨](wp12.md)

---

æŒ‰ï¼šæœ¬ç« å†…å®¹è¾ƒå¤šï¼Œä¸å†åœ¨å…¨éƒ¨åŸæ–‡ä¹‹åæ‰å¼€å§‹è§£è¯»â€”â€”ç›´æ¥å°†è§£è¯»å†…å®¹æ’åˆ°åŸæ–‡ä¸­ï¼Œä¹Ÿä¸å†æŒ‰å¥è§£è¯»ï¼Œè€Œæ˜¯æŒ‰æ®µè½è§£è¯»ã€‚æœ¬ç« è®²è¿°çš„å†…å®¹ï¼Œç›´è§‚ç†è§£è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“ï¼Œä½†è¦å®Œå…¨çœ‹æ‡‚è®¡ç®—å¹¶è¯æ˜ï¼Œå¹¶ä¸å®¹æ˜“ã€‚

## 11. Calculations è®¡ç®—

> We consider the scenario of an attacker trying to generate an alternate chain faster than the honest chain. Even if this is accomplished, it does not throw the system open to arbitrary changes, such as creating value out of thin air or taking money that never belonged to the attacker. Nodes are not going to accept an invalid transaction as payment, and honest nodes will never accept a block containing them. An attacker can only try to change one of his own transactions to take back money he recently spent.

æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªæ”»å‡»è€…è¯•å›¾æ¯”è¯šå®é“¾æ›´å¿«åœ°ç”Ÿæˆå¦ä¸€æ¡é“¾çš„æƒ…å†µã€‚å³ä½¿æ”»å‡»è€…è¾¾åˆ°äº†è¿™ä¸ªç›®æ ‡ï¼Œå®ƒä¹Ÿä¸ä¼šæ‰“å¼€ç³»ç»Ÿè¿›è¡Œä»»æ„æ›´æ”¹ï¼Œæ¯”å¦‚å‡­ç©ºåˆ›é€ ä»·å€¼æˆ–å¤ºå–ä»æœªå±äºæ”»å‡»è€…çš„èµ„é‡‘ã€‚ä¸€ä¸ªæ”»å‡»è€…åªèƒ½å°½å¯èƒ½æ”¹å˜ä»–è‡ªå·±çš„äº¤æ˜“å»æ‹¿å›ä»–æœ€è¿‘èŠ±å‡ºå»çš„é’±ã€‚

åœ¨åŒºå—é“¾ä¸­ï¼Œæ¯ä¸ªåŒºå—éƒ½åŒ…å«ç€å‰ä¸€ä¸ªåŒºå—çš„ä¿¡æ¯ï¼Œå½¢æˆäº†ä¸€ä¸ªä¸å¯ç¯¡æ”¹çš„é“¾æ¡ã€‚æ”»å‡»è€…å¦‚æœæƒ³è¦æ›´æ”¹åŒºå—é“¾ä¸Šçš„ä¿¡æ¯ï¼Œéœ€è¦æ¯”æ•´ä¸ªç½‘ç»œä¸Šçš„å…¶ä»–èŠ‚ç‚¹æ›´å¿«åœ°ç”Ÿæˆä¸€æ¡æ–°çš„é“¾ï¼Œä½¿å¾—å…¶ä»–èŠ‚ç‚¹éƒ½è®¤ä¸ºè¿™æ˜¯æ–°çš„æ­£ç¡®é“¾ã€‚

> The race between the honest chain and an attacker chain can be characterized as a Binomial Random Walk. The success event is the honest chain being extended by one block, increasing its lead by +1, and the failure event is the attacker's chain being extended by one block, reducing the gap by âˆ’1.

è¿™æ®µè¯ä¸»è¦åœ¨è®²åŒºå—é“¾æŠ€æœ¯ä¸­çš„ä¸€ä¸ªæ¦‚å¿µâ€”â€”â€œè¯šå®é“¾â€å’Œâ€œæ”»å‡»é“¾â€çš„ç«äº‰è¿‡ç¨‹å¯ä»¥è¢«æè¿°ä¸ºä¸€ä¸ªäºŒé¡¹å¼éšæœºæ¼«æ­¥ã€‚å…¶ä¸­ï¼ŒæˆåŠŸäº‹ä»¶æ˜¯æŒ‡è¯šå®é“¾è¢«æ‰©å±•äº†ä¸€ä¸ªåŒºå—ï¼Œå¯¼è‡´å…¶é¢†å…ˆä¼˜åŠ¿å¢åŠ äº†+1ï¼›å¤±è´¥äº‹ä»¶åˆ™æ˜¯æŒ‡æ”»å‡»é“¾è¢«æ‰©å±•äº†ä¸€ä¸ªåŒºå—ï¼Œå¯¼è‡´å…¶ä¸è¯šå®é“¾çš„å·®è·å‡å°‘äº†-1ã€‚

äºŒé¡¹å¼éšæœºæ¼«æ­¥æ˜¯ä¸€ç§éšæœºè¿‡ç¨‹ï¼Œå®ƒå¯ä»¥ç”¨æ¥æè¿°æŸä¸ªäº‹ä»¶åœ¨ä¸€ç³»åˆ—ç‹¬ç«‹çš„è¯•éªŒä¸­çš„æ¦‚ç‡åˆ†å¸ƒã€‚åœ¨è¿™é‡Œï¼Œè¯šå®é“¾å’Œæ”»å‡»é“¾çš„ç«äº‰è¿‡ç¨‹å°±å¯ä»¥è¢«çœ‹ä½œä¸€ç³»åˆ—ç‹¬ç«‹çš„è¯•éªŒï¼Œæ¯ä¸€æ¬¡è¯•éªŒéƒ½å¯ä»¥æ˜¯è¯šå®é“¾æˆ–æ”»å‡»é“¾è¢«æ‰©å±•ä¸€ä¸ªåŒºå—çš„äº‹ä»¶ä¹‹ä¸€ã€‚

è¿™ä¸ªæ¦‚å¿µåœ¨åŒºå—é“¾ä¸­éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£åŒºå—é“¾æŠ€æœ¯ä¸­çš„å®‰å…¨æ€§å’Œå»ä¸­å¿ƒåŒ–æ€§è´¨ã€‚é€šè¿‡äº†è§£åŒºå—é“¾æŠ€æœ¯ä¸­çš„å„ç§æ¦‚å¿µå’ŒåŸç†ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°åº”ç”¨è¿™äº›çŸ¥è¯†å»è®¾è®¡å’Œå®ç°æ›´å®‰å…¨ã€æ›´å¯é çš„åŒºå—é“¾ç³»ç»Ÿã€‚

ã€Binomial Random Walkã€‘

Binomial Random Walkï¼ˆäºŒé¡¹å¼éšæœºæ¸¸èµ°ï¼ŒäºŒé¡¹éšæœºæ¼«æ­¥ï¼‰æ˜¯ä¸€ç§éšæœºè¿‡ç¨‹ï¼Œæè¿°äº†ä¸€ç³»åˆ—éšæœºæ­¥é•¿å¯¹ä¸€ä¸ªåˆå§‹å€¼è¿›è¡Œçš„ç´¯åŠ ã€‚åœ¨äºŒé¡¹å¼éšæœºæ¸¸èµ°ä¸­ï¼Œæ¯ä¸€æ­¥çš„æ­¥é•¿å¯ä»¥æ˜¯1æˆ–-1ï¼Œæ¯ä¸ªæ­¥é•¿éƒ½æœ‰ç›¸åŒçš„æ¦‚ç‡å‡ºç°ã€‚æ­¥é•¿çš„æ­£è´Ÿä¸æ¦‚ç‡ç›¸ç­‰çš„ç‰¹æ€§ä½¿å¾—äºŒé¡¹å¼éšæœºæ¸¸èµ°å…·æœ‰å¯¹ç§°æ€§ã€‚

äºŒé¡¹å¼éšæœºæ¸¸èµ°å¯ä»¥ç”¨æ¥æ¨¡æ‹Ÿä¸€äº›å®é™…é—®é¢˜ï¼Œä¾‹å¦‚è‚¡ç¥¨ä»·æ ¼çš„æ³¢åŠ¨ã€éšæœºæ¼«æ­¥ç­‰ã€‚åœ¨é‡‘èé¢†åŸŸï¼ŒäºŒé¡¹å¼éšæœºæ¸¸èµ°è¢«å¹¿æ³›åº”ç”¨äºæœŸæƒå®šä»·æ¨¡å‹ä¸­ï¼Œå…¶ä¸­è‚¡ç¥¨ä»·æ ¼çš„å˜åŒ–è¢«è§†ä¸ºéšæœºæ­¥é•¿çš„ç´¯åŠ ã€‚

å‚[éš¨æ©Ÿæ¼«æ­¥](https://zh.wikipedia.org/wiki/%E9%9A%A8%E6%A9%9F%E6%BC%AB%E6%AD%A5)

> The probability of an attacker catching up from a given deficit is analogous to a Gambler's Ruin problem. Suppose a gambler with unlimited credit starts at a deficit and plays potentially an infinite number of trials to try to reach breakeven. We can calculate the probability he ever reaches breakeven, or that an attacker ever catches up with the honest chain, as follows [^8]:

è¿™æ®µè¯è®²çš„æ˜¯æ”»å‡»è€…ä»ä¸€å®šçš„è½åçŠ¶æ€è¿½èµ¶ä¸Šæ¥çš„æ¦‚ç‡ç±»ä¼¼äºä¸€ä¸ªèµŒå¾’ç ´äº§çš„é—®é¢˜ã€‚å‡è®¾ä¸€ä¸ªèµŒå¾’æœ‰æ— é™çš„ä¿¡ç”¨ï¼Œä»ä¸€ä¸ªäºæŸçŠ¶æ€å¼€å§‹ï¼Œå¯èƒ½è¿›è¡Œæ— é™æ¬¡å°è¯•ä»¥è¾¾åˆ°ç›ˆäºå¹³è¡¡ã€‚æˆ‘ä»¬å¯ä»¥è®¡ç®—ä»–è¾¾åˆ°ç›ˆäºå¹³è¡¡çš„æ¦‚ç‡ï¼Œæˆ–è€…æ”»å‡»è€…è¿½èµ¶ä¸Šè¯šå®é“¾çš„æ¦‚ç‡ï¼Œå¦‚ä¸‹æ‰€è¿°ã€‚

$\large p = \textit{ probability an honest node finds the next block}$ è¯šå®é“¾æ‰¾åˆ°ä¸‹ä¸€ä¸ªåŒºå—çš„æ¦‚ç‡

$\large q = \textit{ probability the attacker finds the next block}$ æ”»å‡»é“¾æ‰¾åˆ°ä¸‹ä¸€ä¸ªåŒºå—çš„æ¦‚ç‡

$\large q_z = \textit{ probability the attacker will ever catch up from z blocks behind}$ æ”»å‡»è€…ä»è½åzå—çš„ä½ç½®è¿½ä¸Šè¯šå®é“¾çš„æ¦‚ç‡

$$
\large q_z = \begin{Bmatrix}
                1 \hspace{4 em} \textit{if}\; p \leq q\\
                \left(\dfrac qp\right)^z \hspace{2 em} \textit{if}\; p \gt q
                \end{Bmatrix}
$$

ä»ç»Ÿè®¡å­¦ä¸Šè®²ï¼Œå¦‚æœ $p\lt q$ï¼Œåˆ™æ”»å‡»é“¾æ¯”è¯šå®é“¾è¿›å±•æ›´å¿«ï¼Œèƒ½è¿½ä¸Šå¹¶è¶…è¿‡ï¼›
å¦‚æœ $p = q$ï¼Œåˆ™æ”»å‡»é“¾å’Œè¯šå®é“¾è¿›å±•ä¸€æ ·å¿«ï¼Œå› ä¸ºè¿™é‡Œå‡è®¾æ˜¯å°è¯•æ— é™æ¬¡çš„ï¼Œâ€œæ— é™â€å’Œâ€œæ— é™+zâ€å¯ä»¥è®¤ä¸ºæ˜¯ç›¸ç­‰çš„ï¼Œåœ¨ç†è®ºä¸Šä¹Ÿç›¸å½“äºè¿½ä¸Šäº†ã€‚
å¦‚æœ $p \gt q$ï¼Œåˆ™è¯šå®é“¾æ›´å®¹æ˜“å»ºç«‹ï¼Œè‡ªç„¶è¿½ä¸ä¸Šã€‚è¿™ä¸ªå…¬å¼è¿˜å¯ä»¥åªè¦ç¬¬äºŒè¡Œï¼Œå¦‚æœç»“æœå¤§äº1ï¼Œå†ä¿®æ­£ä¸º1å°±è¡Œäº†ï¼Œå› ä¸ºæ¦‚ç‡å€¼æœ€å¤§åªèƒ½æ˜¯1ï¼Œè¿™é‡Œå¿…é¡»ä¿®æ­£ã€‚

$$
\large q_z = \left(\dfrac qp\right)^z =
                \begin{Bmatrix}
                1 \hspace{4 em}\textit{if}\; q_z \geq 1\\
                \left(\dfrac qp\right)^z \hspace{1.5 em} \textit{if}\; q_z \lt 1
                \end{Bmatrix}
$$

è¿™ä¸ªå…¬å¼ä»ç›´è§‰ä¸Šå¾ˆå¥½ç†è§£ï¼ŒæˆåŠŸæ‰“åŒ…å‘å¸ƒä¸‹ä¸€ä¸ªåŒºå—çš„æ¦‚ç‡ï¼Œè¯šå®é“¾çš„æ¦‚ç‡æ˜¯$p$ï¼Œæ”»å‡»é“¾çš„æ¦‚ç‡æ˜¯$q$ï¼Œåˆ™æ”»å‡»é“¾ç›¸å¯¹äºè¯šå®é“¾çš„æˆåŠŸæ¦‚ç‡æ˜¯$\dfrac qp$ã€‚å‡è‹¥æ”»å‡»é“¾æ¡è½å$z$å—è¦èµ¶ä¸Šï¼Œåˆ™å®ƒèµ¶ä¸Šçš„æ¦‚ç‡æ˜¯$\left(\dfrac qp\right)^z$. å½“$\dfrac qp < 1$æ—¶ï¼Œå¦‚æœ$z$æ¯”è¾ƒå¤§ï¼Œåˆ™$\left(\dfrac qp\right)^z$å‡ ä¹æ²¡æœ‰å¯èƒ½èµ¶ä¸Šè¯šå®å—ã€‚æ¯”å¦‚

$\dfrac qp = \dfrac 13$ï¼Œè¿™è¯´æ˜æ”»å‡»é“¾æ¡æœ‰è¯šå®é“¾$\dfrac{1}{3}$çš„å¯èƒ½æˆåŠŸå‘å¸ƒä¸‹ä¸€ä¸ªåŒºå—ï¼Œè€Œå†æˆåŠŸå‘å¸ƒä¸€ä¸ªåŒºå—çš„å¯èƒ½æ€§å‡ä¸º$\left(\dfrac 13\right)^2$ï¼Œä¸€æ¬¡ç±»æ¨ï¼ŒæˆåŠŸå‘å¸ƒ$z$ä¸ªåŒºå—çš„æ¦‚ç‡çš„æ¦‚ç‡å°±æ˜¯$\left(\dfrac 13\right)^z$ï¼Œå‡å®š$z = 6$ï¼Œ$\left(\dfrac 13\right)^6 \approx 0.137\%$ã€‚å› ä¸ºç®—åŠ›çš„ä»½é¢å’Œå‘å¸ƒåŒºå—çš„å¯èƒ½æ€§æ˜¯å¯¹åº”çš„ï¼Œè¿™é‡Œå®é™…ä¸Šç›¸å½“äºå‡è®¾æ”»å‡»èŠ‚ç‚¹æ‹¥æœ‰$\dfrac 13$æ‹¥æœ‰è¯šå®ç»“ç‚¹çš„ç®—åŠ›ï¼Œä¹Ÿå°±æ˜¯æ”»å‡»èŠ‚ç‚¹çš„ç®—åŠ›å å…¨ç½‘çš„$\dfrac 14$ï¼Œè¿™æ˜¯éå¸¸å¤¸å¼ çš„å‡è®¾ï¼Œå®é™…ä¸Šå¾ˆéš¾æœ‰æŸä¸ªåŠ¿åŠ›èƒ½æœ‰è¿™ä¹ˆå¤§çš„ç®—åŠ›ã€‚å³ä¾¿æ˜¯è¿™æ ·ï¼Œé€šè¿‡è®¡ç®—å¾—çŸ¥ï¼Œè¦èµ¶ä¸Š6ä¸ªå¿«çš„å¯èƒ½æ€§ä¹Ÿåªæœ‰$0.137\%$ï¼ŒæŒ‰ååˆ†é’Ÿä¸€ä¸ªåŒºå—ï¼Œå¯¹åº”çš„æ—¶é—´çº¦ä¸€ä¸ªå°æ—¶ã€‚

æ‰€ä»¥å½“ä¸€ä¸ªåŒºå—è¢«å…¨ç½‘æ¥å—åï¼Œå¾ˆéš¾è¢«ç¯¡æ”¹ã€‚

* deficit, èµ¤å­—ï¼ŒäºæŸï¼Œä¸è¶³é¢
* Gambler's Ruin, [èµŒå¾’ç ´äº§ç†è®º](https://zh.wikipedia.org/wiki/%E8%B5%8C%E5%BE%92%E7%A0%B4%E4%BA%A7%E7%90%86%E8%AE%BA)
* breakeven, ç›ˆäºå¹³è¡¡ç‚¹ï¼Œä¿æœ¬çš„ä½ç½®ï¼Œä¸èµšä¸èµ”

> Given our assumption that $p>q$, the probability drops exponentially as the number of blocks the attacker has to catch up with increases. With the odds against him, if he doesn't make a lucky lunge forward early on, his chances become vanishingly small as he falls further behind.

æˆ‘ä»¬å‡è®¾$p>q$ï¼Œåˆ™è¿½ä¸Šè¯šå®é“¾å¢é•¿çš„å¯èƒ½æ€§æŒ‰éœ€è¦è¿½èµ¶çš„åŒºå—æ•°é‡å‘ˆæŒ‡æ•°ä¸‹é™ã€‚å› ä¸ºä»–é¢ä¸´ä¸åˆ©æƒ…å†µï¼ˆèƒœç®—ä¸é«˜ï¼‰ï¼Œå¦‚æœä»–ä¸åœ¨æ—©æœŸè¿›è¡Œå¹¸è¿çš„å‘å‰å†²ï¼Œéšç€ä»–è½åçš„ç¨‹åº¦è¶Šæ¥è¶Šå¤§ï¼Œä»–çš„æœºä¼šå°±å˜å¾—å¾®ä¹å…¶å¾®äº†ã€‚

> We now consider how long the recipient of a new transaction needs to wait before being sufficiently certain the sender can't change the transaction. We assume the sender is an attacker who wants to make the recipient believe he paid him for a while, then switch it to pay back to himself after some time has passed. The receiver will be alerted when that happens, but the sender hopes it will be too late.

æˆ‘ä»¬ç°åœ¨è€ƒè™‘ä¸€ä¸ªäº¤æ˜“çš„æ”¶æ¬¾äººè¦ç­‰å¤šä¹…æ‰èƒ½ç¡®è®¤ä»˜æ¬¾äººä¸èƒ½ç¯¡æ”¹äº¤æ˜“ã€‚æˆ‘ä»¬å‡è®¾ä»˜æ¬¾äººæ˜¯ä¸€ä¸ªæ”»å‡»è€…ï¼Œä»–æƒ³è®©æ¥æ”¶è€…ç›¸ä¿¡ä»–å·²ç»æ”¯ä»˜äº†ï¼Œä½†æ—‹å³æŠŠé’±å‘å›ç»™è‡ªå·±ã€‚å¦‚æœé‚£ç§æƒ…å†µå‘ç”Ÿï¼Œæ”¶æ¬¾äººå°†è¢«è­¦å‘Šï¼Œä½†æ˜¯å‘é€è€…å¸Œæœ›è­¦å‘Šå¾ˆæ™šã€‚

> The receiver generates a new key pair and gives the public key to the sender shortly before signing. This prevents the sender from preparing a chain of blocks ahead of time by working on it continuously until he is lucky enough to get far enough ahead, then executing the transaction at that moment. Once the transaction is sent, the dishonest sender starts working in secret on a parallel chain containing an alternate version of his transaction.

æ”¶æ¬¾äººåˆ›å»ºä¸€ä¸ªæ–°çš„å¯†é’¥å¯¹ç„¶åæŠŠå…¬é’¥ç»™ä»˜æ¬¾äººï¼Œè¿™æ ·ä»˜æ¬¾äººå°±æ— æ³•æå‰å¯¹äº¤æ˜“ç­¾åã€‚è¿™é˜»æ­¢äº†å‘é€è€…è¯•å›¾å‡†å¤‡ä¸€æ¡é“¾ï¼Œä»–æŒç»­å·¥ä½œåœ¨è¿™æ¡é“¾ä¸Šï¼Œä»–è¶³å¤Ÿå¹¸è¿å¹¶å¤§å¹…é¢†å…ˆï¼Œç„¶ååœ¨é‚£æ—¶æ‰§è¡Œäº¤æ˜“ã€‚

> The recipient waits until the transaction has been added to a block and z blocks have been linked after it. He doesn't know the exact amount of progress the attacker has made, but assuming the honest blocks took the average expected time per block, the attacker's potential progress will be a Poisson distribution with expected value:

æ”¶æ¬¾äººç­‰å¾…äº¤æ˜“è¢«æ·»åŠ è¿›æŸä¸ªåŒºå—ä¸­å¹¶ä¸”zä¸ªåŒºå—å·²ç»é“¾æ¥åˆ°å‰é¢è¿™ä¸ªåŒºå—åã€‚ä»–ä¸çŸ¥é“æ”»å‡»è€…å…·ä½“æ€ä¹ˆåšçš„ï¼Œä½†æ˜¯å‡è®¾è¯šå®çš„åŒºå—ç”¨æ‰äº†æ¯ä¸ªåŒºå—é¢„æœŸçš„æ—¶é—´ï¼Œè¿™ä¸ªæ”»å‡»è€…å¯èƒ½çš„è¿›åº¦å°†æ˜¯ä¸€ä¸ªæ³Šæ¾åˆ†å¸ƒï¼Œå…¶æœŸæœ›å€¼ä¸º

$$
\large \lambda = z \frac qp
$$

> To get the probability the attacker could still catch up now, we multiply the Poisson density for each amount of progress he could have made by the probability he could catch up from that point:

ä¸ºè®¡ç®—æ”»å‡»è€…ç°åœ¨ä»èƒ½èµ¶ä¸Šçš„æ¦‚ç‡ï¼Œæˆ‘ä»¬ç»™ä»–å¯èƒ½åˆ°è¾¾çš„è¿›åº¦çš„æ³Šæ¾å¯†åº¦ä¹˜ä»¥ä»–åœ¨é‚£ä¸ªè¿›åº¦èƒ½èµ¶ä¸Šè¯šå®é“¾çš„æ¦‚ç‡ï¼š

$$
\large \sum_{k=0}^{\infty} \frac{\lambda^k e^{-\lambda}}{k!} \cdot
                \begin{Bmatrix}
                (q/p)^{(z-k)} \hspace{1 em} \textit{if}\;k\leq z\\
                1 \hspace{4 em} \textit{if} \; k \gt z
                \end{Bmatrix}
$$

> Rearranging to avoid summing the infinite tail of the distribution...

å˜æ¢ä»¥é¿å…å¯¹åˆ†å¸ƒçš„æ— é™å°¾éƒ¨æ±‚å’Œâ€¦ 

$$
\large 1 - \sum_{k=0}^{z} \frac{\lambda^k e^{-\lambda}}{k!}
                \left ( 1-(q/p)^{(z-k)} \right )
$$

> Converting to C code...

è½¬æˆCä»£ç â€¦ 

```c
#include <math.h>
double AttackerSuccessProbability(double q, int z)
{
    double p = 1.0 - q;
    double lambda = z * (q / p);
    double sum = 1.0;
    int i, k;
    for (k = 0; k <= z; k++)
    {
        double poisson = exp(-lambda);
        for (i = 1; i <= k; i++)
            poisson *= lambda / i;
        sum -= poisson * (1 - pow(q / p, z - k));
    }
    return sum;
 }
```

> Running some results, we can see the probability drop off exponentially with z.

è¿è¡Œå¾—åˆ°ä¸€äº›ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¦‚ç‡éšzå‘ˆæŒ‡æ•°ä¸‹é™ã€‚

```plaintext
q=0.1
z=0     P=1.0000000
z=1     P=0.2045873
z=2     P=0.0509779
z=3     P=0.0131722
z=4     P=0.0034552
z=5     P=0.0009137
z=6     P=0.0002428
z=7     P=0.0000647
z=8     P=0.0000173
z=9     P=0.0000046
z=10    P=0.0000012
q=0.3
z=0     P=1.0000000
z=5     P=0.1773523
z=10    P=0.0416605
z=15    P=0.0101008
z=20    P=0.0024804
z=25    P=0.0006132
z=30    P=0.0001522
z=35    P=0.0000379
z=40    P=0.0000095
z=45    P=0.0000024
z=50    P=0.0000006
```

> Solving for P less than 0.1%...

På°äº0.1%çš„è§£â€¦

```plaintext
P < 0.001
q=0.10   z=5
q=0.15   z=8
q=0.20   z=11
q=0.25   z=15
q=0.30   z=24
q=0.35   z=41
q=0.40   z=89
q=0.45   z=340
```

---

å‚è€ƒèµ„æ–™

* [^8] W. Feller, "An introduction to probability theory and its applications," 1957.

---

[â‡¦ä¸Šä¸€ç« ](wp10.md) - [è¿”å›ç›®å½•ğŸ“–](whitepaper.md) - [ä¸‹ä¸€ç« â‡¨](wp12.md)
